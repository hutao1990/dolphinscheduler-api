package org.apache.dolphinscheduler.api.patch;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import org.apache.commons.lang3.StringUtils;
import org.apache.dolphinscheduler.api.patch.bean.NodePosition;

import java.util.*;
import java.util.stream.Collectors;

/**
 * @author hutao
 * @date 2021/9/9 17:15
 * @description
 */
public class PositionCalc {

    public static Collection<NodePosition> calcPosition(String connects) {
        Map<String, NodePosition> positionsMap = getPositionList(connects);
        //计算深度
        calcPositionsDepth(positionsMap, null, 0);
        int max = positionsMap.values().stream().map(NodePosition::getDepth).max(Comparator.comparingInt(Integer::intValue)).get();
        System.out.println("max:" + max);
        //计算横向顺序及横坐标
        Map<Integer, Integer> map = calcPositionsWidth(positionsMap);
        int maxWidth = positionsMap.values().stream().map(NodePosition::getWidth).max(Comparator.comparingInt(Integer::intValue)).get();

        //减少线段交点
        //reduceFocusPoint(positionsMap, map);

        //居中对齐
        adjustWidth(positionsMap, map, maxWidth);


        return positionsMap.values();
    }

    public static String createLocations(String connects){
        Collection<NodePosition> nodePositions = calcPosition(connects);
        JSONObject json = new JSONObject(true);
        for (NodePosition nodePosition : nodePositions) {
            JSONObject obj = new JSONObject(true);
            obj.put("name",nodePosition.getName());
            obj.put("nodenumber",nodePosition.getPreDeps()== null?0:nodePosition.getPreDeps().size()+"");
            obj.put("targetarr", StringUtils.join(nodePosition.getAfterDeps(),","));
            obj.put("x", nodePosition.getWidth() * 12);
            obj.put("y", nodePosition.getDepth() * 500);
            json.put(nodePosition.getName(),obj);
        }
        return json.toJSONString();
    }

    private static void reduceFocusPoint(Map<String, NodePosition> positionsMap, Map<Integer, Integer> map) {
        List<NodePosition> ends = positionsMap.values().stream().filter(n -> n.isEnd()).sorted(Comparator.comparingInt(NodePosition::getDepth)).collect(Collectors.toList());
        Collections.reverse(ends);
        Map<Integer, Map<Integer,NodePosition>> positionMap = new HashMap<>();
        positionsMap.values().forEach(p ->{
            int depth = p.getDepth();
            int order = p.getOrder();
            if (positionMap.containsKey(depth)){
                positionMap.get(depth).put(order,p);
            }else {
                Map<Integer,NodePosition> orderMap = new HashMap<>();
                orderMap.put(order,p);
                positionMap.put(depth,orderMap);
            }
        });
        Map<Integer, Integer> depthMaxOrderCount = new HashMap<>();
        ends.forEach(n ->{
            exchangePosition(positionsMap, positionMap, depthMaxOrderCount, n);
        });

    }

    private static void exchangePosition(Map<String, NodePosition> positionsMap,Map<Integer, Map<Integer,NodePosition>> positionMap, Map<Integer, Integer> depthMaxOrderCount, NodePosition nextPosition){
        Set<String> preDeps = nextPosition.getPreDeps();
        if (nextPosition.getOrder() < positionMap.get(nextPosition.getDepth()).size()){

        }
        for (String preDep : preDeps) {
            NodePosition nodePosition = positionsMap.get(preDep);
        }
    }

    private static void adjustWidth(Map<String, NodePosition> positionsMap, Map<Integer, Integer> map, int maxWidth) {
        for (Integer key : map.keySet()) {
            map.put(key, (maxWidth - map.get(key)) / 2);
        }
        for (String key : positionsMap.keySet()) {
            NodePosition nodePosition = positionsMap.get(key);
            nodePosition.setWidth(nodePosition.getWidth() + map.getOrDefault(nodePosition.getDepth(), maxWidth / 2));
        }
    }

    private static Map<Integer, Integer> calcPositionsWidth(Map<String, NodePosition> positionsMap) {
        List<NodePosition> collect = positionsMap.values().stream().sorted(Comparator.comparingInt(NodePosition::getDepth)).collect(Collectors.toList());
        int currDepth = 0;
        int order = 0;
        int width = 0;
        Map<Integer, Integer> map = new HashMap<>();
        for (NodePosition nodePosition : collect) {
            if (currDepth != nodePosition.getDepth()) {
                map.put(currDepth, width);
                order = 1;
                width = nodePosition.getLength();
                currDepth = nodePosition.getDepth();
                nodePosition.setOrder(order);
                nodePosition.setWidth(width);
            } else {
                order = order + 1;
                width = nodePosition.getLength() + width;
                nodePosition.setOrder(order);
                nodePosition.setWidth(width);
            }
            positionsMap.put(nodePosition.getName(), nodePosition);
        }

        return map;
    }

    private static void calcPositionsDepth(Map<String, NodePosition> positionsMap, List<String> lastDepthTasks, int depth) {
        List<String> tasks = new ArrayList<>();
        if (depth == 0) {
            for (NodePosition position : positionsMap.values()) {
                if (position.isFirst()) {
                    position.setDepth(0);
                    tasks.add(position.getName());
                }
            }
            calcPositionsDepth(positionsMap, tasks, depth + 1);
        } else {
            depth = depth + 1;
            for (String lastDepthTask : lastDepthTasks) {
                NodePosition nodePosition = positionsMap.get(lastDepthTask);
                if (!nodePosition.isEnd()) {
                    Set<String> afterDeps = nodePosition.getAfterDeps();
                    if (null != afterDeps && afterDeps.size() > 0) {
                        depthAdd(positionsMap, afterDeps, depth - 1);
                        calcPositionsDepth(positionsMap, new ArrayList<>(afterDeps), depth);
                    }
                }
            }
        }
    }

    private static void depthAdd(Map<String, NodePosition> positionsMap, Set<String> after, int depth) {
        for (String s : after) {
            NodePosition nodePosition = positionsMap.get(s);
            if (nodePosition.getDepth() <= depth) {
                nodePosition.setDepth(depth);
            }
        }
    }

    private static Map<String, NodePosition> getPositionList(String connects) {
        JSONArray arr = JSON.parseArray(connects);
        Set<String> taskSet = new HashSet<>();
        Map<String, Set<String>> taskPreDepsMap = new HashMap<>();
        Map<String, Set<String>> taskAfterDepsMap = new HashMap<>();
        for (int i = 0; i < arr.size(); i++) {
            JSONObject json = arr.getJSONObject(i);
            String endPointSourceId = json.getString("endPointSourceId");
            String endPointTargetId = json.getString("endPointTargetId");
            taskSet.add(endPointSourceId);
            taskSet.add(endPointTargetId);
            fillMap(taskAfterDepsMap, endPointSourceId, endPointTargetId);
            fillMap(taskPreDepsMap, endPointTargetId, endPointSourceId);
        }
        Map<String, NodePosition> map = new HashMap<>();
        for (String s : taskSet) {
            NodePosition position = new NodePosition();
            position.setName(s);
            position.setPreDeps(taskPreDepsMap.get(s));
            position.setAfterDeps(taskAfterDepsMap.get(s));
            map.put(s, position);
        }
        taskPreDepsMap.clear();
        taskAfterDepsMap.clear();
        return map;
    }

    private static void fillMap(Map<String, Set<String>> map, String source, String target) {
        if (map.containsKey(source)) {
            Set<String> set = map.get(source);
            set.add(target);
        } else {
            Set<String> set = new TreeSet<>();
            set.add(target);
            map.put(source, set);
        }
    }

    public static String createGraph(Collection<NodePosition> positions, String connects) {
        JSONObject json = new JSONObject(true);
        List<JSONObject> nodes = new ArrayList<>();
        String rootName = null;
        for (NodePosition position : positions) {
            if (position.isFirst()) {
                rootName = position.getName();
            }
            JSONObject obj = new JSONObject(true);
            obj.put("id", position.getName());
            obj.put("text", position.getName());
            obj.put("x", position.getWidth() * 12);
            obj.put("y", position.getDepth() * 500);
            obj.put("fixed", true);
            nodes.add(obj);
        }

        JSONArray arr = JSON.parseArray(connects);
        List<JSONObject> links = new ArrayList<>();
        for (int i = 0; i < arr.size(); i++) {
            JSONObject js = arr.getJSONObject(i);
            String endPointSourceId = js.getString("endPointSourceId");
            String endPointTargetId = js.getString("endPointTargetId");
            JSONObject obj = new JSONObject(true);
            obj.put("from", endPointSourceId);
            obj.put("to", endPointTargetId);
            links.add(obj);
        }

        json.put("rootId", rootName);
        json.put("nodes", nodes);
        json.put("links", links);
        return json.toJSONString();
    }

    public static void main(String[] args) {
        String connects = "[{\"endPointSourceId\":\"fdm__fdm_org_all_employee_staff_ps_gome_mdm\",\"endPointTargetId\":\"dim__dim_org_all_employee_user_info\"},{\"endPointSourceId\":\"fdm__fdm_org_all_employee_dim_employee_info\",\"endPointTargetId\":\"dim__dim_org_all_employee_user_info\"},{\"endPointSourceId\":\"dim__dim_org_all_store_base_info\",\"endPointTargetId\":\"dim__dim_org_all_employee_user_info\"},{\"endPointSourceId\":\"check__stage__gome_organization_gome_mdm\",\"endPointTargetId\":\"dim__dim_org_all_gome_organization\"},{\"endPointSourceId\":\"fdm__fdm_org_all_store_dim_store_info\",\"endPointTargetId\":\"dim__dim_org_all_store_base_info\"},{\"endPointSourceId\":\"fdm__fdm_org_all_store_full_gome_mdm\",\"endPointTargetId\":\"dim__dim_org_all_store_expand_info\"},{\"endPointSourceId\":\"dim__dim_org_all_store_base_info\",\"endPointTargetId\":\"dim__dim_org_all_store_expand_info\"},{\"endPointSourceId\":\"fdm__fdm_shop_all_pop_tbl_shop\",\"endPointTargetId\":\"dim__dim_shop_all_shop_info\"},{\"endPointSourceId\":\"fdm__fdm_shop_all_pop_merchant\",\"endPointTargetId\":\"dim__dim_shop_all_shop_info\"},{\"endPointSourceId\":\"fdm__fdm_shop_all_pop_operators\",\"endPointTargetId\":\"dim__dim_shop_all_shop_info\"},{\"endPointSourceId\":\"dim__dim_org_all_employee_user_info\",\"endPointTargetId\":\"dim__dim_shop_all_shop_info\"},{\"endPointSourceId\":\"dim__dim_sku_all_sku\",\"endPointTargetId\":\"dim__dim_shop_all_shop_info\"},{\"endPointSourceId\":\"fdm__fdm_shop_all_pop_employee_login_info\",\"endPointTargetId\":\"dim__dim_shop_all_shop_info\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_nbcc_base_category_sap\",\"endPointTargetId\":\"dim__dim_sku_all_offline_category\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_catb_dcs_cat_chldcat\",\"endPointTargetId\":\"dim__dim_sku_all_online_category\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_catb_dcs_category\",\"endPointTargetId\":\"dim__dim_sku_all_online_category\"},{\"endPointSourceId\":\"edm__edm_sku_all_sku\",\"endPointTargetId\":\"dim__dim_sku_all_sku\"},{\"endPointSourceId\":\"fdm__fdm_order_all_wangpi_so_delivery_doc\",\"endPointTargetId\":\"edm__edm_order_all_wangpi_order_sku_detail\"},{\"endPointSourceId\":\"fdm__fdm_order_all_wangpi_so_sku_items\",\"endPointTargetId\":\"edm__edm_order_all_wangpi_order_sku_detail\"},{\"endPointSourceId\":\"fdm__fdm_order_all_wangpi_sales_order\",\"endPointTargetId\":\"edm__edm_order_all_wangpi_order_sku_detail\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_supplier_info\",\"endPointTargetId\":\"edm__edm_order_all_wangpi_order_sku_detail\"},{\"endPointSourceId\":\"fdm__fdm_order_all_wangpi_so_delivery\",\"endPointTargetId\":\"edm__edm_order_all_wangpi_order_sku_detail\"},{\"endPointSourceId\":\"dim__dim_org_all_store_base_info\",\"endPointTargetId\":\"edm__edm_order_all_wangpi_order_sku_detail\"},{\"endPointSourceId\":\"dim__dim_sku_all_sku\",\"endPointTargetId\":\"edm__edm_order_all_wangpi_order_sku_detail\"},{\"endPointSourceId\":\"check__dim__dim_org_v2_order_site_type\",\"endPointTargetId\":\"edm__edm_order_day_all_dl_detail-jinli\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_company_info\",\"endPointTargetId\":\"edm__edm_order_day_all_dl_detail-jinli\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_supplier_info\",\"endPointTargetId\":\"edm__edm_order_day_all_dl_detail-jinli\"},{\"endPointSourceId\":\"edm__edm_order_day_jinli_bookkeeping_date_detail\",\"endPointTargetId\":\"edm__edm_order_day_all_dl_detail-jinli\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_promotion_amount\",\"endPointTargetId\":\"edm__edm_order_day_all_dl_detail-jinli\"},{\"endPointSourceId\":\"dim__dim_org_all_store_base_info\",\"endPointTargetId\":\"edm__edm_order_day_all_dl_detail-jinli\"},{\"endPointSourceId\":\"edm__edm_order_day_jinli_account_code\",\"endPointTargetId\":\"edm__edm_order_day_all_dl_detail-jinli\"},{\"endPointSourceId\":\"dim__dim_sku_all_sku\",\"endPointTargetId\":\"edm__edm_order_day_all_dl_detail-jinli\"},{\"endPointSourceId\":\"check__dim__dim_org_v2_order_site_type\",\"endPointTargetId\":\"edm__edm_order_day_all_dl_detail-oms\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_dl_info\",\"endPointTargetId\":\"edm__edm_order_day_all_dl_detail-oms\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_supplier_info\",\"endPointTargetId\":\"edm__edm_order_day_all_dl_detail-oms\"},{\"endPointSourceId\":\"dim__dim_org_all_store_base_info\",\"endPointTargetId\":\"edm__edm_order_day_all_dl_detail-oms\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_payment_group\",\"endPointTargetId\":\"edm__edm_order_day_all_dl_detail-oms\"},{\"endPointSourceId\":\"dim__dim_sku_all_sku\",\"endPointTargetId\":\"edm__edm_order_day_all_dl_detail-oms\"},{\"endPointSourceId\":\"check__dim__dim_org_v2_order_site_type\",\"endPointTargetId\":\"edm__edm_order_day_all_eff2_detail-jinli\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_company_info\",\"endPointTargetId\":\"edm__edm_order_day_all_eff2_detail-jinli\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_supplier_info\",\"endPointTargetId\":\"edm__edm_order_day_all_eff2_detail-jinli\"},{\"endPointSourceId\":\"edm__edm_order_day_jinli_bookkeeping_date_detail\",\"endPointTargetId\":\"edm__edm_order_day_all_eff2_detail-jinli\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_promotion_amount\",\"endPointTargetId\":\"edm__edm_order_day_all_eff2_detail-jinli\"},{\"endPointSourceId\":\"dim__dim_org_all_store_base_info\",\"endPointTargetId\":\"edm__edm_order_day_all_eff2_detail-jinli\"},{\"endPointSourceId\":\"edm__edm_order_day_jinli_account_code\",\"endPointTargetId\":\"edm__edm_order_day_all_eff2_detail-jinli\"},{\"endPointSourceId\":\"dim__dim_sku_all_sku\",\"endPointTargetId\":\"edm__edm_order_day_all_eff2_detail-jinli\"},{\"endPointSourceId\":\"check__dim__dim_org_v2_order_site_type\",\"endPointTargetId\":\"edm__edm_order_day_all_eff2_detail-oms\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_loss_info\",\"endPointTargetId\":\"edm__edm_order_day_all_eff2_detail-oms\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_supplier_info\",\"endPointTargetId\":\"edm__edm_order_day_all_eff2_detail-oms\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_onlinepay_cashsubmit\",\"endPointTargetId\":\"edm__edm_order_day_all_eff2_detail-oms\"},{\"endPointSourceId\":\"dim__dim_org_all_store_base_info\",\"endPointTargetId\":\"edm__edm_order_day_all_eff2_detail-oms\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_payment_group\",\"endPointTargetId\":\"edm__edm_order_day_all_eff2_detail-oms\"},{\"endPointSourceId\":\"dim__dim_sku_all_sku\",\"endPointTargetId\":\"edm__edm_order_day_all_eff2_detail-oms\"},{\"endPointSourceId\":\"dim__dim_org_all_employee_user_info\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_dl_detail-jinli\"},{\"endPointSourceId\":\"edm__edm_order_day_all_dl_detail-jinli\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_dl_detail-jinli\"},{\"endPointSourceId\":\"dim__dim_org_all_employee_user_info\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_dl_detail-oms\"},{\"endPointSourceId\":\"eds__eds_order_v2_achievement_attribution\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_dl_detail-oms\"},{\"endPointSourceId\":\"dim__dim_org_all_store_base_info\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_dl_detail-oms\"},{\"endPointSourceId\":\"edm__edm_order_day_all_dl_detail-oms\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_dl_detail-oms\"},{\"endPointSourceId\":\"edm__edm_order_day_all_eff2_detail-jinli\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_eff2_detail-jinli\"},{\"endPointSourceId\":\"dim__dim_org_all_employee_user_info\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_eff2_detail-jinli\"},{\"endPointSourceId\":\"edm__edm_order_day_all_eff2_detail-oms\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_eff2_detail-oms\"},{\"endPointSourceId\":\"dim__dim_org_all_employee_user_info\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_eff2_detail-oms\"},{\"endPointSourceId\":\"eds__eds_order_v2_achievement_attribution\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_eff2_detail-oms\"},{\"endPointSourceId\":\"dim__dim_org_all_store_base_info\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_eff2_detail-oms\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_order_detail-eff2\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_order_detail-submit\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_order_detail-dl\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_order_detail-dl_oms\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-dl\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_order_detail-dl_jinli\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-dl\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_dl_detail-jinli\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-dl_jinli\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_dl_detail-oms\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-dl_oms\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_order_detail-eff2_oms\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-eff2\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_order_detail-eff2_wangpi\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-eff2\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_order_detail-eff2_jinli\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-eff2\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_order_detail-eff2_otm84\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-eff2\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_eff2_detail-jinli\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-eff2_jinli\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_eff2_detail-oms\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-eff2_oms\"},{\"endPointSourceId\":\"edm__edm_order_day_otm84_extend_eff2_detail\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-eff2_otm84\"},{\"endPointSourceId\":\"edm__edm_order_day_wangpi_extend_eff2_detail\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-eff2_wangpi\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_order_detail-submit_oms\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-submit\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_order_detail-submit_jinli\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-submit\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_submit_detail-jinli\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-submit_jinli\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_submit_detail-oms\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_order_detail-submit_oms\"},{\"endPointSourceId\":\"edm__edm_order_day_all_submit_detail-jinli\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_submit_detail-jinli\"},{\"endPointSourceId\":\"dim__dim_org_all_employee_user_info\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_submit_detail-jinli\"},{\"endPointSourceId\":\"edm__edm_order_day_all_submit_detail-oms\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_submit_detail-oms\"},{\"endPointSourceId\":\"dim__dim_org_all_employee_user_info\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_submit_detail-oms\"},{\"endPointSourceId\":\"eds__eds_order_v2_achievement_attribution\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_submit_detail-oms\"},{\"endPointSourceId\":\"dim__dim_org_all_store_base_info\",\"endPointTargetId\":\"edm__edm_order_day_all_extend_submit_detail-oms\"},{\"endPointSourceId\":\"edm__edm_order_day_all_order_detail-submit\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail\"},{\"endPointSourceId\":\"edm__edm_order_day_all_order_detail-eff2\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail\"},{\"endPointSourceId\":\"edm__edm_order_day_all_order_detail-dl\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail\"},{\"endPointSourceId\":\"edm__edm_order_day_all_order_detail-dl_jinli\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-dl\"},{\"endPointSourceId\":\"edm__edm_order_day_all_order_detail-dl_oms\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-dl\"},{\"endPointSourceId\":\"edm__edm_order_day_all_dl_detail-jinli\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-dl_jinli\"},{\"endPointSourceId\":\"edm__edm_order_day_all_dl_detail-oms\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-dl_oms\"},{\"endPointSourceId\":\"edm__edm_order_day_all_order_detail-eff2_wangpi\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-eff2\"},{\"endPointSourceId\":\"edm__edm_order_day_all_order_detail-eff2_otm84\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-eff2\"},{\"endPointSourceId\":\"edm__edm_order_day_all_order_detail-eff2_jinli\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-eff2\"},{\"endPointSourceId\":\"edm__edm_order_day_all_order_detail-eff2_oms\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-eff2\"},{\"endPointSourceId\":\"edm__edm_order_day_all_eff2_detail-jinli\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-eff2_jinli\"},{\"endPointSourceId\":\"edm__edm_order_day_all_eff2_detail-oms\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-eff2_oms\"},{\"endPointSourceId\":\"edm__edm_order_day_otm84_eff2_detail\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-eff2_otm84\"},{\"endPointSourceId\":\"edm__edm_order_day_wangpi_eff2_detail\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-eff2_wangpi\"},{\"endPointSourceId\":\"edm__edm_order_day_all_order_detail-submit_jinli\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-submit\"},{\"endPointSourceId\":\"edm__edm_order_day_all_order_detail-submit_oms\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-submit\"},{\"endPointSourceId\":\"edm__edm_order_day_all_submit_detail-jinli\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-submit_jinli\"},{\"endPointSourceId\":\"edm__edm_order_day_all_submit_detail-oms\",\"endPointTargetId\":\"edm__edm_order_day_all_order_detail-submit_oms\"},{\"endPointSourceId\":\"check__dim__dim_org_v2_order_site_type\",\"endPointTargetId\":\"edm__edm_order_day_all_submit_detail-jinli\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_company_info\",\"endPointTargetId\":\"edm__edm_order_day_all_submit_detail-jinli\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_supplier_info\",\"endPointTargetId\":\"edm__edm_order_day_all_submit_detail-jinli\"},{\"endPointSourceId\":\"edm__edm_order_day_jinli_bookkeeping_date_detail\",\"endPointTargetId\":\"edm__edm_order_day_all_submit_detail-jinli\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_promotion_amount\",\"endPointTargetId\":\"edm__edm_order_day_all_submit_detail-jinli\"},{\"endPointSourceId\":\"dim__dim_org_all_store_base_info\",\"endPointTargetId\":\"edm__edm_order_day_all_submit_detail-jinli\"},{\"endPointSourceId\":\"edm__edm_order_day_jinli_account_code\",\"endPointTargetId\":\"edm__edm_order_day_all_submit_detail-jinli\"},{\"endPointSourceId\":\"dim__dim_sku_all_sku\",\"endPointTargetId\":\"edm__edm_order_day_all_submit_detail-jinli\"},{\"endPointSourceId\":\"check__dim__dim_org_v2_order_site_type\",\"endPointTargetId\":\"edm__edm_order_day_all_submit_detail-oms\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_supplier_info\",\"endPointTargetId\":\"edm__edm_order_day_all_submit_detail-oms\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_submit_date_detail\",\"endPointTargetId\":\"edm__edm_order_day_all_submit_detail-oms\"},{\"endPointSourceId\":\"dim__dim_org_all_store_base_info\",\"endPointTargetId\":\"edm__edm_order_day_all_submit_detail-oms\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_payment_group\",\"endPointTargetId\":\"edm__edm_order_day_all_submit_detail-oms\"},{\"endPointSourceId\":\"dim__dim_sku_all_sku\",\"endPointTargetId\":\"edm__edm_order_day_all_submit_detail-oms\"},{\"endPointSourceId\":\"edm__edm_order_day_all_order_detail-eff2\",\"endPointTargetId\":\"edm__edm_order_day_eff2_light\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_account_code\",\"endPointTargetId\":\"edm__edm_order_day_jinli_account_code\"},{\"endPointSourceId\":\"fdm__fdm_order_day_jinli_order\",\"endPointTargetId\":\"edm__edm_order_day_jinli_account_code\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_transaction_info\",\"endPointTargetId\":\"edm__edm_order_day_jinli_account_code\"},{\"endPointSourceId\":\"edm__edm_order_day_jinli_bookkeeping_date_detail\",\"endPointTargetId\":\"edm__edm_order_day_jinli_account_code\"},{\"endPointSourceId\":\"fdm__fdm_order_day_jinli_order\",\"endPointTargetId\":\"edm__edm_order_day_jinli_bookkeeping_date_detail\"},{\"endPointSourceId\":\"fdm__fdm_order_day_jinli_sku\",\"endPointTargetId\":\"edm__edm_order_day_jinli_bookkeeping_date_detail\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_customer_info\",\"endPointTargetId\":\"edm__edm_order_day_jinli_bookkeeping_date_detail\"},{\"endPointSourceId\":\"check__fds__fds_user_m_uc_pf_gome_bindcard_user\",\"endPointTargetId\":\"edm__edm_order_day_jinli_bookkeeping_date_detail\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_shipping_group\",\"endPointTargetId\":\"edm__edm_order_day_oms_create_information\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_shipping_group_info\",\"endPointTargetId\":\"edm__edm_order_day_oms_create_information\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_shop_info\",\"endPointTargetId\":\"edm__edm_order_day_oms_create_information\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_order\",\"endPointTargetId\":\"edm__edm_order_day_oms_create_information\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_item_address\",\"endPointTargetId\":\"edm__edm_order_day_oms_create_information\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_g3pp_true_reserve\",\"endPointTargetId\":\"edm__edm_order_day_oms_create_information\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_item_info\",\"endPointTargetId\":\"edm__edm_order_day_oms_create_information\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_shipping_group_address\",\"endPointTargetId\":\"edm__edm_order_day_oms_create_information\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_item\",\"endPointTargetId\":\"edm__edm_order_day_oms_create_information\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_sku\",\"endPointTargetId\":\"edm__edm_order_day_oms_create_information\"},{\"endPointSourceId\":\"fdm__fdm_order_year2_oms_order_info\",\"endPointTargetId\":\"edm__edm_order_day_oms_create_information\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_item_price_info\",\"endPointTargetId\":\"edm__edm_order_day_oms_create_information\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_payment_group\",\"endPointTargetId\":\"edm__edm_order_day_oms_create_information\"},{\"endPointSourceId\":\"fdm__fdm_order_year2_oms_item_details\",\"endPointTargetId\":\"edm__edm_order_day_oms_create_information\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_order\",\"endPointTargetId\":\"edm__edm_order_day_oms_details_share_amount\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_detail_amount\",\"endPointTargetId\":\"edm__edm_order_day_oms_details_share_amount\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_payment_group\",\"endPointTargetId\":\"edm__edm_order_day_oms_details_share_amount\"},{\"endPointSourceId\":\"fdm__fdm_order_year2_oms_item_details\",\"endPointTargetId\":\"edm__edm_order_day_oms_details_share_amount\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_shipping_laststate_date\",\"endPointTargetId\":\"edm__edm_order_day_oms_dl_info\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_return_exchange_info\",\"endPointTargetId\":\"edm__edm_order_day_oms_dl_info\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_submit_date_detail\",\"endPointTargetId\":\"edm__edm_order_day_oms_dl_info\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_shipping_laststate_date\",\"endPointTargetId\":\"edm__edm_order_day_oms_loss_info\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_return_exchange_info\",\"endPointTargetId\":\"edm__edm_order_day_oms_loss_info\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_submit_date_detail\",\"endPointTargetId\":\"edm__edm_order_day_oms_loss_info\"},{\"endPointSourceId\":\"fdm__fdm_order_year2_oms_item_details\",\"endPointTargetId\":\"edm__edm_order_day_oms_loss_info\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_payment_info\",\"endPointTargetId\":\"edm__edm_order_day_oms_onlinepay_cashsubmit\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_submit_date_detail\",\"endPointTargetId\":\"edm__edm_order_day_oms_onlinepay_cashsubmit\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_order\",\"endPointTargetId\":\"edm__edm_order_day_oms_payment_info\"},{\"endPointSourceId\":\"check__dim__dim_org_v2_payment_account_code\",\"endPointTargetId\":\"edm__edm_order_day_oms_payment_info\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_payment_transaction\",\"endPointTargetId\":\"edm__edm_order_day_oms_payment_info\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_payment_group\",\"endPointTargetId\":\"edm__edm_order_day_oms_payment_info\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_gome_refund_request\",\"endPointTargetId\":\"edm__edm_order_day_oms_refund_info\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_order\",\"endPointTargetId\":\"edm__edm_order_day_oms_return_exchange_created\"},{\"endPointSourceId\":\"fdm__fdm_order_all_roms_shipgroup\",\"endPointTargetId\":\"edm__edm_order_day_oms_return_exchange_created\"},{\"endPointSourceId\":\"fdm__fdm_order_all_roms_item_info\",\"endPointTargetId\":\"edm__edm_order_day_oms_return_exchange_created\"},{\"endPointSourceId\":\"fdm__fdm_order_all_roms_item\",\"endPointTargetId\":\"edm__edm_order_day_oms_return_exchange_created\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_order\",\"endPointTargetId\":\"edm__edm_order_day_oms_return_exchange_info\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_refund_info\",\"endPointTargetId\":\"edm__edm_order_day_oms_return_exchange_info\"},{\"endPointSourceId\":\"fdm__fdm_order_all_roms_shipgroup\",\"endPointTargetId\":\"edm__edm_order_day_oms_return_exchange_info\"},{\"endPointSourceId\":\"fdm__fdm_order_all_roms_item_info\",\"endPointTargetId\":\"edm__edm_order_day_oms_return_exchange_info\"},{\"endPointSourceId\":\"fdm__fdm_order_all_roms_item\",\"endPointTargetId\":\"edm__edm_order_day_oms_return_exchange_info\"},{\"endPointSourceId\":\"fdm__fdm_order_all_roms_order\",\"endPointTargetId\":\"edm__edm_order_day_oms_return_exchange_info\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_order\",\"endPointTargetId\":\"edm__edm_order_day_oms_shipping_laststate_date\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_shipping_group\",\"endPointTargetId\":\"edm__edm_order_day_oms_shipping_laststate_date\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_shipping_group_info\",\"endPointTargetId\":\"edm__edm_order_day_oms_shipping_laststate_date\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_order\",\"endPointTargetId\":\"edm__edm_order_day_oms_state_change\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_shipping_group\",\"endPointTargetId\":\"edm__edm_order_day_oms_state_change\"},{\"endPointSourceId\":\"fdm__fdm_order_all_oms_shipping_group_info\",\"endPointTargetId\":\"edm__edm_order_day_oms_state_change\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_create_information\",\"endPointTargetId\":\"edm__edm_order_day_oms_submit_date_detail\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_state_change\",\"endPointTargetId\":\"edm__edm_order_day_oms_submit_date_detail\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_payment_info\",\"endPointTargetId\":\"edm__edm_order_day_oms_submit_date_detail\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_return_exchange_info\",\"endPointTargetId\":\"edm__edm_order_day_oms_submit_date_detail\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_details_share_amount\",\"endPointTargetId\":\"edm__edm_order_day_oms_submit_date_detail\"},{\"endPointSourceId\":\"fdm__fdm_order_all_jinli_supplier_info\",\"endPointTargetId\":\"edm__edm_order_day_otm84_eff2_detail\"},{\"endPointSourceId\":\"dim__dim_org_all_gome_organization\",\"endPointTargetId\":\"edm__edm_order_day_otm84_eff2_detail\"},{\"endPointSourceId\":\"dim__dim_org_all_store_base_info\",\"endPointTargetId\":\"edm__edm_order_day_otm84_eff2_detail\"},{\"endPointSourceId\":\"edm__edm_order_day_otm84_order_info\",\"endPointTargetId\":\"edm__edm_order_day_otm84_eff2_detail\"},{\"endPointSourceId\":\"dim__dim_sku_all_sku\",\"endPointTargetId\":\"edm__edm_order_day_otm84_eff2_detail\"},{\"endPointSourceId\":\"edm__edm_order_day_otm84_eff2_detail\",\"endPointTargetId\":\"edm__edm_order_day_otm84_extend_eff2_detail\"},{\"endPointSourceId\":\"fdm__fdm_order_all_otm84_shipping\",\"endPointTargetId\":\"edm__edm_order_day_otm84_order_info\"},{\"endPointSourceId\":\"fdm__fdm_order_all_otm84_order_sku\",\"endPointTargetId\":\"edm__edm_order_day_otm84_order_info\"},{\"endPointSourceId\":\"fdm__fdm_order_all_otm84_order\",\"endPointTargetId\":\"edm__edm_order_day_otm84_order_info\"},{\"endPointSourceId\":\"edm__edm_order_all_wangpi_order_sku_detail\",\"endPointTargetId\":\"edm__edm_order_day_wangpi_eff2_detail\"},{\"endPointSourceId\":\"edm__edm_order_day_wangpi_eff2_detail\",\"endPointTargetId\":\"edm__edm_order_day_wangpi_extend_eff2_detail\"},{\"endPointSourceId\":\"fdm__fdm_supply_all_md_sales_channel\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail\"},{\"endPointSourceId\":\"fdm__fdm_supply_all_md_company\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_nbcc_base_brand\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail\"},{\"endPointSourceId\":\"fdm__fdm_supply_all_md_supplier\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail\"},{\"endPointSourceId\":\"dim__dim_sku_all_sku\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail\"},{\"endPointSourceId\":\"dim__dim_org_all_store_expand_info\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail\"},{\"endPointSourceId\":\"edm__edm_sap_month_sales_zpsd001_merge\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail\"},{\"endPointSourceId\":\"dim__dim_sku_all_offline_category\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail\"},{\"endPointSourceId\":\"check__dim__dim_sap_all_load_sales_model\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail\"},{\"endPointSourceId\":\"fdm__fdm_supply_all_md_class\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail\"},{\"endPointSourceId\":\"check__edm__edm_sap_day_sales_zpsd001_rundt\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail\"},{\"endPointSourceId\":\"fdm__fdm_supply_all_md_buyorg\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail\"},{\"endPointSourceId\":\"fdm__fdm_supply_all_md_sales_channel\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail_extend\"},{\"endPointSourceId\":\"fdm__fdm_supply_all_md_company\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail_extend\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_nbcc_base_brand\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail_extend\"},{\"endPointSourceId\":\"fdm__fdm_supply_all_md_supplier\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail_extend\"},{\"endPointSourceId\":\"dim__dim_sku_all_sku\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail_extend\"},{\"endPointSourceId\":\"dim__dim_org_all_store_expand_info\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail_extend\"},{\"endPointSourceId\":\"edm__edm_sap_month_sales_zpsd001_merge\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail_extend\"},{\"endPointSourceId\":\"dim__dim_sku_all_offline_category\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail_extend\"},{\"endPointSourceId\":\"check__dim__dim_sap_all_load_sales_model\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail_extend\"},{\"endPointSourceId\":\"fdm__fdm_supply_all_md_class\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail_extend\"},{\"endPointSourceId\":\"check__edm__edm_sap_day_sales_zpsd001_rundt\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail_extend\"},{\"endPointSourceId\":\"fdm__fdm_supply_all_md_buyorg\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail_extend\"},{\"endPointSourceId\":\"edm__edm_supply_all_pzorg_map_branch_region\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail_regione\"},{\"endPointSourceId\":\"edm__edm_sap_month_sales_detail\",\"endPointTargetId\":\"edm__edm_sap_month_sales_detail_regione\"},{\"endPointSourceId\":\"fdm__fdm_sap_month_sales_zpsd001_settlement\",\"endPointTargetId\":\"edm__edm_sap_month_sales_zpsd001_merge\"},{\"endPointSourceId\":\"edm__edm_sap_month_sales_zpsd001_nosettlement\",\"endPointTargetId\":\"edm__edm_sap_month_sales_zpsd001_merge\"},{\"endPointSourceId\":\"check__edm__edm_sap_day_sales_zpsd001_rundt\",\"endPointTargetId\":\"edm__edm_sap_month_sales_zpsd001_merge\"},{\"endPointSourceId\":\"fdm__fdm_sap_month_sales_zpsd001_modify\",\"endPointTargetId\":\"edm__edm_sap_month_sales_zpsd001_nosettlement\"},{\"endPointSourceId\":\"fdm__fdm_sap_day_sales_zpsd001\",\"endPointTargetId\":\"edm__edm_sap_month_sales_zpsd001_nosettlement\"},{\"endPointSourceId\":\"check__fds__fds_sensors_event_flow_new\",\"endPointTargetId\":\"edm__edm_sensors_day_event_flow_new\"},{\"endPointSourceId\":\"dim__dim_org_all_employee_user_info\",\"endPointTargetId\":\"edm__edm_sensors_day_event_flow_new\"},{\"endPointSourceId\":\"dim__dim_org_all_store_base_info\",\"endPointTargetId\":\"edm__edm_sensors_day_event_flow_new\"},{\"endPointSourceId\":\"dim__dim_sku_all_sku\",\"endPointTargetId\":\"edm__edm_sensors_day_event_flow_new\"},{\"endPointSourceId\":\"check__dim__dim_bhv_event\",\"endPointTargetId\":\"edm__edm_sensors_day_event_view\"},{\"endPointSourceId\":\"check__dim__dim_bhv_site\",\"endPointTargetId\":\"edm__edm_sensors_day_event_view\"},{\"endPointSourceId\":\"check__fds__fds_sensors_event_flow_new\",\"endPointTargetId\":\"edm__edm_sensors_day_event_view\"},{\"endPointSourceId\":\"dim__dim_org_all_employee_user_info\",\"endPointTargetId\":\"edm__edm_sensors_day_event_view\"},{\"endPointSourceId\":\"dim__dim_org_all_store_base_info\",\"endPointTargetId\":\"edm__edm_sensors_day_event_view\"},{\"endPointSourceId\":\"check__eds2__eds_sku_v2_online_offline_sku\",\"endPointTargetId\":\"edm__edm_sensors_day_event_view\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_nbcc_base_sku\",\"endPointTargetId\":\"edm__edm_sku_all_offline_sku\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_nbcc_base_sku_info\",\"endPointTargetId\":\"edm__edm_sku_all_offline_sku\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_nbcc_base_business\",\"endPointTargetId\":\"edm__edm_sku_all_offline_sku\"},{\"endPointSourceId\":\"dim__dim_sku_all_offline_category\",\"endPointTargetId\":\"edm__edm_sku_all_offline_sku\"},{\"endPointSourceId\":\"check__eds2__eds_item_sku_v2_category_brand\",\"endPointTargetId\":\"edm__edm_sku_all_offline_sku\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_nbcc_base_brand\",\"endPointTargetId\":\"edm__edm_sku_all_offline_sku\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_catb_gome_dcs_prd_brand\",\"endPointTargetId\":\"edm__edm_sku_all_online_sku\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_nbcc_base_business\",\"endPointTargetId\":\"edm__edm_sku_all_online_sku\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_catb_gome_sku_shop\",\"endPointTargetId\":\"edm__edm_sku_all_online_sku\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_catb_gome_dcs_sku_sap\",\"endPointTargetId\":\"edm__edm_sku_all_online_sku\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_catb_dcs_product\",\"endPointTargetId\":\"edm__edm_sku_all_online_sku\"},{\"endPointSourceId\":\"dim__dim_sku_all_online_category\",\"endPointTargetId\":\"edm__edm_sku_all_online_sku\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_catb_dcs_sku\",\"endPointTargetId\":\"edm__edm_sku_all_online_sku\"},{\"endPointSourceId\":\"check__dim__dim_org_v2_category_department\",\"endPointTargetId\":\"edm__edm_sku_all_online_sku\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_catb_gome_brand\",\"endPointTargetId\":\"edm__edm_sku_all_online_sku\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_catb_dcs_cat_chldprd\",\"endPointTargetId\":\"edm__edm_sku_all_online_sku\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_catb_dcs_prd_chldsku\",\"endPointTargetId\":\"edm__edm_sku_all_online_sku\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_catb_gome_dcs_sku\",\"endPointTargetId\":\"edm__edm_sku_all_online_sku\"},{\"endPointSourceId\":\"fdm__fdm_sku_all_catx_gome_bbc_merchant\",\"endPointTargetId\":\"edm__edm_sku_all_online_sku\"},{\"endPointSourceId\":\"edm__edm_sku_all_offline_sku\",\"endPointTargetId\":\"edm__edm_sku_all_sku\"},{\"endPointSourceId\":\"edm__edm_sku_all_online_sku\",\"endPointTargetId\":\"edm__edm_sku_all_sku\"},{\"endPointSourceId\":\"fdm__fdm_supply_all_md_region\",\"endPointTargetId\":\"edm__edm_supply_all_pzorg_map_branch_region\"},{\"endPointSourceId\":\"fdm__fdm_supply_all_pzorg\",\"endPointTargetId\":\"edm__edm_supply_all_pzorg_map_branch_region\"},{\"endPointSourceId\":\"fdm__fdm_supply_all_md_branch1\",\"endPointTargetId\":\"edm__edm_supply_all_pzorg_map_branch_region\"},{\"endPointSourceId\":\"fdm__fdm_supply_all_md_branch2\",\"endPointTargetId\":\"edm__edm_supply_all_pzorg_map_branch_region\"},{\"endPointSourceId\":\"check__stage__delivery_gmzhtorder\",\"endPointTargetId\":\"eds__eds_maotai_all_o2o_order\"},{\"endPointSourceId\":\"check__stage__sales_order_gmzhtorder\",\"endPointTargetId\":\"eds__eds_maotai_all_o2o_order\"},{\"endPointSourceId\":\"check__stage__fdxsmx_gmretail\",\"endPointTargetId\":\"eds__eds_maotai_all_o2o_order\"},{\"endPointSourceId\":\"check__stage__sales_order_sku_items_gmzhtorder\",\"endPointTargetId\":\"eds__eds_maotai_all_o2o_order\"},{\"endPointSourceId\":\"check__stage__fdxs_gmretail\",\"endPointTargetId\":\"eds__eds_maotai_all_o2o_order\"},{\"endPointSourceId\":\"check__eds2__eds_sku_v2_online_offline_sku\",\"endPointTargetId\":\"eds__eds_maotai_all_o2o_order\"},{\"endPointSourceId\":\"check__scot_dim__dim_shop_info\",\"endPointTargetId\":\"eds__eds_maotai_all_o2o_order_purchase\"},{\"endPointSourceId\":\"eds__eds_maotai_all_o2o_order\",\"endPointTargetId\":\"eds__eds_maotai_all_o2o_order_purchase\"},{\"endPointSourceId\":\"check__stage__zmch1_sapsr3\",\"endPointTargetId\":\"eds__eds_maotai_all_o2o_order_purchase\"},{\"endPointSourceId\":\"check__stage__mchb_sapsr3\",\"endPointTargetId\":\"eds__eds_maotai_all_o2o_order_purchase\"},{\"endPointSourceId\":\"check__scot_dim__dim_contract_info\",\"endPointTargetId\":\"eds__eds_maotai_all_o2o_order_purchase\"},{\"endPointSourceId\":\"check__stage__mdlyspxx_gmretail\",\"endPointTargetId\":\"eds__eds_maotai_all_o2o_order_purchase\"},{\"endPointSourceId\":\"fds__fds_helpguest_bangke_full_order_detail\",\"endPointTargetId\":\"eds__eds_order_v2_achievement_attribution\"},{\"endPointSourceId\":\"fds__fds_award_all_crp_calc_result\",\"endPointTargetId\":\"eds__eds_order_v2_achievement_attribution\"},{\"endPointSourceId\":\"edm__edm_order_day_all_order_detail-submit_oms\",\"endPointTargetId\":\"eds__eds_order_v2_achievement_attribution\"},{\"endPointSourceId\":\"check__eds2__eds_org_v2_employee_user_configuration\",\"endPointTargetId\":\"eds__eds_order_v2_achievement_attribution\"},{\"endPointSourceId\":\"check__ods__s_skfs_gmscm\",\"endPointTargetId\":\"fdm__fdm_order_all_jinli_account_code\"},{\"endPointSourceId\":\"check__ods__s_gsxx_gmscm\",\"endPointTargetId\":\"fdm__fdm_order_all_jinli_company_info\"},{\"endPointSourceId\":\"check__ods__s_lsxskhxx_gmscm\",\"endPointTargetId\":\"fdm__fdm_order_all_jinli_customer_info\"},{\"endPointSourceId\":\"check__ods__s_rtcxf_gmscm\",\"endPointTargetId\":\"fdm__fdm_order_all_jinli_promotion_amount\"},{\"endPointSourceId\":\"check__ods__s_wldw_gmscm\",\"endPointTargetId\":\"fdm__fdm_order_all_jinli_supplier_info\"},{\"endPointSourceId\":\"check__ods__s_lsxsskje_gmscm\",\"endPointTargetId\":\"fdm__fdm_order_all_jinli_transaction_info\"},{\"endPointSourceId\":\"check__stage__tms_waybill_lmis_pall\",\"endPointTargetId\":\"fdm__fdm_order_all_lmis_tms_waybill\"},{\"endPointSourceId\":\"check__stage__sales_order_items_collect_gmretail\",\"endPointTargetId\":\"fdm__fdm_order_all_o2o_detail\"},{\"endPointSourceId\":\"check__stage__oms_detail_amount_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_oms_detail_amount\"},{\"endPointSourceId\":\"check__stage__oms_g3pp_true_reserve_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_oms_g3pp_true_reserve\"},{\"endPointSourceId\":\"check__stage__oms_gome_refund_request_refunddb\",\"endPointTargetId\":\"fdm__fdm_order_all_oms_gome_refund_request\"},{\"endPointSourceId\":\"check__stage__oms_item_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_oms_item\"},{\"endPointSourceId\":\"check__stage__oms_item_address_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_oms_item_address\"},{\"endPointSourceId\":\"check__stage__oms_item_info_gome_oms_inc\",\"endPointTargetId\":\"fdm__fdm_order_all_oms_item_info\"},{\"endPointSourceId\":\"check__stage__oms_item_price_info_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_oms_item_price_info\"},{\"endPointSourceId\":\"check__stage__oms_order_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_oms_order\"},{\"endPointSourceId\":\"check__stage__oms_payment_group_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_oms_payment_group\"},{\"endPointSourceId\":\"check__stage__oms_payment_transaction_gome_oms_inc\",\"endPointTargetId\":\"fdm__fdm_order_all_oms_payment_transaction\"},{\"endPointSourceId\":\"check__stage__oms_shipping_group_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_oms_shipping_group\"},{\"endPointSourceId\":\"check__stage__oms_shipping_group_address_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_oms_shipping_group_address\"},{\"endPointSourceId\":\"check__stage__oms_shipping_group_info_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_oms_shipping_group_info\"},{\"endPointSourceId\":\"check__stage__oms_shop_info_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_oms_shop_info\"},{\"endPointSourceId\":\"check__stage__oms_sku_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_oms_sku\"},{\"endPointSourceId\":\"check__stage__gmxsdd_o2m_oc_pop\",\"endPointTargetId\":\"fdm__fdm_order_all_otm84_order\"},{\"endPointSourceId\":\"check__stage__gmxsddsp_o2m_oc_pop\",\"endPointTargetId\":\"fdm__fdm_order_all_otm84_order_sku\"},{\"endPointSourceId\":\"check__stage__gmxsddfd_o2m_oc_pop\",\"endPointTargetId\":\"fdm__fdm_order_all_otm84_shipping\"},{\"endPointSourceId\":\"check__stage__roms_item_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_roms_item\"},{\"endPointSourceId\":\"check__stage__roms_item_info_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_roms_item_info\"},{\"endPointSourceId\":\"check__stage__roms_order_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_roms_order\"},{\"endPointSourceId\":\"check__stage__roms_order_info_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_roms_order_info\"},{\"endPointSourceId\":\"check__stage__roms_shipgroup_gome_oms_ogg\",\"endPointTargetId\":\"fdm__fdm_order_all_roms_shipgroup\"},{\"endPointSourceId\":\"check__stage__sales_order_bhsorder\",\"endPointTargetId\":\"fdm__fdm_order_all_wangpi_sales_order\"},{\"endPointSourceId\":\"check__stage__so_delivery_bhsorder\",\"endPointTargetId\":\"fdm__fdm_order_all_wangpi_so_delivery\"},{\"endPointSourceId\":\"check__stage__so_delivery_doc_bhsorder\",\"endPointTargetId\":\"fdm__fdm_order_all_wangpi_so_delivery_doc\"},{\"endPointSourceId\":\"check__stage__so_sku_items_bhsorder\",\"endPointTargetId\":\"fdm__fdm_order_all_wangpi_so_sku_items\"},{\"endPointSourceId\":\"check__ods__s_lsxsjl_gmscm\",\"endPointTargetId\":\"fdm__fdm_order_day_jinli_order\"},{\"endPointSourceId\":\"check__ods__s_lsxssp_gmscm_dz\",\"endPointTargetId\":\"fdm__fdm_order_day_jinli_sku\"},{\"endPointSourceId\":\"check__stage__oms_item_details_gome_oms_inc\",\"endPointTargetId\":\"fdm__fdm_order_year2_oms_item_details\"},{\"endPointSourceId\":\"check__stage__oms_order_info_gome_oms_inc\",\"endPointTargetId\":\"fdm__fdm_order_year2_oms_order_info\"},{\"endPointSourceId\":\"check__dim2__dim_employee_info\",\"endPointTargetId\":\"fdm__fdm_org_all_employee_dim_employee_info\"},{\"endPointSourceId\":\"check__stage__gome_sales_staff_ps_gome_mdm\",\"endPointTargetId\":\"fdm__fdm_org_all_employee_staff_ps_gome_mdm\"},{\"endPointSourceId\":\"check__dim2__dim_shop_info\",\"endPointTargetId\":\"fdm__fdm_org_all_store_dim_store_info\"},{\"endPointSourceId\":\"check__stage__gome_store_full_gome_mdm\",\"endPointTargetId\":\"fdm__fdm_org_all_store_full_gome_mdm\"},{\"endPointSourceId\":\"check__supply_scot_dp__int_jl_ys\",\"endPointTargetId\":\"fdm__fdm_sap_all_budget_amount_branch_dept\"},{\"endPointSourceId\":\"check__supply_scot_dp__ys_md_new\",\"endPointTargetId\":\"fdm__fdm_sap_all_budget_amount_store\"},{\"endPointSourceId\":\"check__stage__bic_azps_d00100_sappb1\",\"endPointTargetId\":\"fdm__fdm_sap_day_sales_zpsd001\"},{\"endPointSourceId\":\"check__ods__bic_azps_d00100_sappb1_yj\",\"endPointTargetId\":\"fdm__fdm_sap_month_sales_zpsd001_modify\"},{\"endPointSourceId\":\"check__ods__bic_azps_d00100_sappb1_yj\",\"endPointTargetId\":\"fdm__fdm_sap_month_sales_zpsd001_settlement\"},{\"endPointSourceId\":\"check__stage__tbl_user_pop_user\",\"endPointTargetId\":\"fdm__fdm_shop_all_pop_employee_login_info\"},{\"endPointSourceId\":\"check__stage__tbl_shop_merchant_gomebbc\",\"endPointTargetId\":\"fdm__fdm_shop_all_pop_merchant\"},{\"endPointSourceId\":\"check__stage__tbl_shop_usercode_gomebbc_ogg\",\"endPointTargetId\":\"fdm__fdm_shop_all_pop_operators\"},{\"endPointSourceId\":\"check__stage__tbl_shop_gomebbc_ogg\",\"endPointTargetId\":\"fdm__fdm_shop_all_pop_tbl_shop\"},{\"endPointSourceId\":\"check__stage__dcs_category_catb_ogg\",\"endPointTargetId\":\"fdm__fdm_sku_all_catb_dcs_category\"},{\"endPointSourceId\":\"check__stage__dcs_cat_chldcat_catb_ogg\",\"endPointTargetId\":\"fdm__fdm_sku_all_catb_dcs_cat_chldcat\"},{\"endPointSourceId\":\"check__stage__dcs_cat_chldprd_catb_ogg\",\"endPointTargetId\":\"fdm__fdm_sku_all_catb_dcs_cat_chldprd\"},{\"endPointSourceId\":\"check__stage__dcs_prd_chldsku_catb_ogg\",\"endPointTargetId\":\"fdm__fdm_sku_all_catb_dcs_prd_chldsku\"},{\"endPointSourceId\":\"check__stage__dcs_product_catb_ogg\",\"endPointTargetId\":\"fdm__fdm_sku_all_catb_dcs_product\"},{\"endPointSourceId\":\"check__stage__dcs_sku_catb_ogg\",\"endPointTargetId\":\"fdm__fdm_sku_all_catb_dcs_sku\"},{\"endPointSourceId\":\"check__stage__gome_brand_catb_ogg\",\"endPointTargetId\":\"fdm__fdm_sku_all_catb_gome_brand\"},{\"endPointSourceId\":\"check__stage__gome_dcs_prd_brand_catb_ogg\",\"endPointTargetId\":\"fdm__fdm_sku_all_catb_gome_dcs_prd_brand\"},{\"endPointSourceId\":\"check__stage__gome_dcs_sku_catb_ogg\",\"endPointTargetId\":\"fdm__fdm_sku_all_catb_gome_dcs_sku\"},{\"endPointSourceId\":\"check__stage__gome_dcs_sku_sap_catb_ogg\",\"endPointTargetId\":\"fdm__fdm_sku_all_catb_gome_dcs_sku_sap\"},{\"endPointSourceId\":\"check__stage__gome_sku_shop_catb_ogg\",\"endPointTargetId\":\"fdm__fdm_sku_all_catb_gome_sku_shop\"},{\"endPointSourceId\":\"check__stage__gome_bbc_merchant_bbc_catx_ogg\",\"endPointTargetId\":\"fdm__fdm_sku_all_catx_gome_bbc_merchant\"},{\"endPointSourceId\":\"check__stage__base_brand_nbcc\",\"endPointTargetId\":\"fdm__fdm_sku_all_nbcc_base_brand\"},{\"endPointSourceId\":\"check__stage__base_business_nbcc\",\"endPointTargetId\":\"fdm__fdm_sku_all_nbcc_base_business\"},{\"endPointSourceId\":\"check__stage__base_category_sap_nbcc\",\"endPointTargetId\":\"fdm__fdm_sku_all_nbcc_base_category_sap\"},{\"endPointSourceId\":\"check__stage__base_sku_nbcc\",\"endPointTargetId\":\"fdm__fdm_sku_all_nbcc_base_sku\"},{\"endPointSourceId\":\"check__stage__base_sku_info_nbcc\",\"endPointTargetId\":\"fdm__fdm_sku_all_nbcc_base_sku_info\"},{\"endPointSourceId\":\"check__stage__md_branch_basic_data\",\"endPointTargetId\":\"fdm__fdm_supply_all_md_branch1\"},{\"endPointSourceId\":\"check__stage__md_sale_grp_basic_data\",\"endPointTargetId\":\"fdm__fdm_supply_all_md_branch2\"},{\"endPointSourceId\":\"check__stage__md_brand_scs\",\"endPointTargetId\":\"fdm__fdm_supply_all_md_brand\"},{\"endPointSourceId\":\"check__stage__md_buyorg_scs\",\"endPointTargetId\":\"fdm__fdm_supply_all_md_buyorg\"},{\"endPointSourceId\":\"check__stage__md_class_scs\",\"endPointTargetId\":\"fdm__fdm_supply_all_md_class\"},{\"endPointSourceId\":\"check__stage__md_company_scs\",\"endPointTargetId\":\"fdm__fdm_supply_all_md_company\"},{\"endPointSourceId\":\"check__stage__md_region_basic_data\",\"endPointTargetId\":\"fdm__fdm_supply_all_md_region\"},{\"endPointSourceId\":\"check__stage__md_sales_channel_basic_data\",\"endPointTargetId\":\"fdm__fdm_supply_all_md_sales_channel\"},{\"endPointSourceId\":\"check__stage__md_supp_scs\",\"endPointTargetId\":\"fdm__fdm_supply_all_md_supplier\"},{\"endPointSourceId\":\"check__stage__bic_pzorg_sappb1\",\"endPointTargetId\":\"fdm__fdm_supply_all_pzorg\"},{\"endPointSourceId\":\"check__stage__crp_calc_result_gome_crp_prd\",\"endPointTargetId\":\"fds__fds_award_all_crp_calc_result\"},{\"endPointSourceId\":\"check__kudu_eds2__realtime_full_channel_order\",\"endPointTargetId\":\"fds__fds_helpguest_bangke_full_order_detail\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__crp_calc_result_gome_crp_prd\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__gome_dcs_sku_catb_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__dcs_sku_catb_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__gome_dcs_sku_sap_catb_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__fdxsmx_gmretail\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__dcs_cat_chldprd_catb_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__gome_brand_catb_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__dim__dim_bhv_site\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__dim__dim_org_v2_payment_account_code\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__base_business_nbcc\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__dcs_cat_chldcat_catb_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__dcs_category_catb_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__ods__s_lsxsjl_gmscm\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__ods__bic_azps_d00100_sappb1_yj\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__ods__s_lsxsskje_gmscm\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__gome_sku_shop_catb_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__sales_order_bhsorder\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_detail_amount_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__tbl_shop_gomebbc_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__roms_order_info_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__dcs_product_catb_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__md_region_basic_data\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__sales_order_gmzhtorder\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__roms_item_info_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__scot_dim__dim_contract_info\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__zmch1_sapsr3\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__so_sku_items_bhsorder\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__dim__dim_org_v2_category_department\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__gmxsdd_o2m_oc_pop\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_item_price_info_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__ods__s_lsxssp_gmscm_dz\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__eds2__eds_org_v2_employee_user_configuration\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__so_delivery_doc_bhsorder\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__md_company_scs\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__md_sales_channel_basic_data\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__ods__s_gsxx_gmscm\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__fds__fds_user_m_uc_pf_gome_bindcard_user\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__tbl_user_pop_user\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__eds2__eds_sku_v2_online_offline_sku\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__scot_dim__dim_shop_info\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__supply_scot_dp__int_jl_ys\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__mdlyspxx_gmretail\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__gome_store_full_gome_mdm\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__roms_item_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__gome_organization_gome_mdm\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__delivery_gmzhtorder\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__ods__s_lsxskhxx_gmscm\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__dim__dim_sap_all_load_sales_model\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__roms_order_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__gmxsddsp_o2m_oc_pop\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_item_address_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__gome_bbc_merchant_bbc_catx_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__base_brand_nbcc\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__md_branch_basic_data\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__mchb_sapsr3\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__gmxsddfd_o2m_oc_pop\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__md_supp_scs\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__kudu_eds2__realtime_full_channel_order\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_gome_refund_request_refunddb\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_order_info_gome_oms_inc\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__md_brand_scs\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_sku_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_g3pp_true_reserve_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__fds__fds_sensors_event_flow_new\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__supply_scot_dp__ys_md_new\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_payment_transaction_gome_oms_inc\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__tbl_shop_merchant_gomebbc\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__bic_azps_d00100_sappb1\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_payment_group_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_item_info_gome_oms_inc\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__base_sku_nbcc\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__fdxs_gmretail\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__gome_sales_staff_ps_gome_mdm\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__md_class_scs\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__edm__edm_sap_day_sales_zpsd001_rundt\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__dcs_prd_chldsku_catb_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__base_sku_info_nbcc\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__bic_pzorg_sappb1\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__so_delivery_bhsorder\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__dim__dim_bhv_event\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__md_buyorg_scs\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_shipping_group_address_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__dim2__dim_employee_info\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_shipping_group_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_order_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__md_sale_grp_basic_data\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__sales_order_sku_items_gmzhtorder\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__eds2__eds_item_sku_v2_category_brand\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__ods__s_rtcxf_gmscm\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_item_details_gome_oms_inc\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__ods__s_wldw_gmscm\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__sales_order_items_collect_gmretail\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__dim__dim_org_v2_order_site_type\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_item_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__gome_dcs_prd_brand_catb_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_shop_info_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__base_category_sap_nbcc\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__tbl_shop_usercode_gomebbc_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__dim2__dim_shop_info\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__ods__s_skfs_gmscm\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__tms_waybill_lmis_pall\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__oms_shipping_group_info_gome_oms_ogg\"},{\"endPointSourceId\":\"dag_start\",\"endPointTargetId\":\"check__stage__roms_shipgroup_gome_oms_ogg\"},{\"endPointSourceId\":\"fdm__fdm_order_all_o2o_detail\",\"endPointTargetId\":\"dag_end\"},{\"endPointSourceId\":\"fdm__fdm_order_all_lmis_tms_waybill\",\"endPointTargetId\":\"dag_end\"},{\"endPointSourceId\":\"fdm__fdm_sap_all_budget_amount_store\",\"endPointTargetId\":\"dag_end\"},{\"endPointSourceId\":\"fdm__fdm_sap_all_budget_amount_branch_dept\",\"endPointTargetId\":\"dag_end\"},{\"endPointSourceId\":\"fdm__fdm_order_all_roms_order_info\",\"endPointTargetId\":\"dag_end\"},{\"endPointSourceId\":\"fdm__fdm_supply_all_md_brand\",\"endPointTargetId\":\"dag_end\"},{\"endPointSourceId\":\"edm__edm_order_day_oms_return_exchange_created\",\"endPointTargetId\":\"dag_end\"},{\"endPointSourceId\":\"eds__eds_maotai_all_o2o_order_purchase\",\"endPointTargetId\":\"dag_end\"},{\"endPointSourceId\":\"edm__edm_sensors_day_event_view\",\"endPointTargetId\":\"dag_end\"},{\"endPointSourceId\":\"edm__edm_sap_month_sales_detail_extend\",\"endPointTargetId\":\"dag_end\"},{\"endPointSourceId\":\"edm__edm_sensors_day_event_flow_new\",\"endPointTargetId\":\"dag_end\"},{\"endPointSourceId\":\"dim__dim_shop_all_shop_info\",\"endPointTargetId\":\"dag_end\"},{\"endPointSourceId\":\"edm__edm_sap_month_sales_detail_regione\",\"endPointTargetId\":\"dag_end\"},{\"endPointSourceId\":\"edm__edm_order_day_all_order_detail\",\"endPointTargetId\":\"dag_end\"},{\"endPointSourceId\":\"edm__edm_order_day_eff2_light\",\"endPointTargetId\":\"dag_end\"},{\"endPointSourceId\":\"edm__edm_order_day_all_extend_order_detail\",\"endPointTargetId\":\"dag_end\"}]";

        Collection<NodePosition> nodePositions = PositionCalc.calcPosition(connects);
        long l1 = System.currentTimeMillis();
        String graph = PositionCalc.createGraph(nodePositions, connects);
        long l2 = System.currentTimeMillis();
        System.out.println((l2 - l1) + "ms");
        System.out.println(graph);
    }
}
